import { PackageManagerTabs } from '@theme'

# Rslib

`storybook-addon-rslib` loads your Rslib configuration and applies it to Storybook Rsbuild so both builds share the same defaults. It also unlocks an easy workflow for testing Module Federation (`mf`) outputs.

See the [Rslib React component sandbox](https://github.com/rspack-contrib/storybook-rsbuild/tree/main/sandboxes/rslib-react-component) for a complete example.

## Getting started

### Installation

<PackageManagerTabs command="install storybook-addon-rslib -D" />

### Configure `.storybook/main.ts`

```ts
export default {
  addons: ['storybook-addon-rslib'],
}
```

Or pass custom options:

```ts
export default {
  addons: [
    {
      name: 'storybook-addon-rslib',
      options: {
        // See the Options section below.
      },
    },
  ],
}
```

## Module Federation support

Follow the [Rslib Module Federation guide](https://rslib.rs/guide/advanced/module-federation) to generate the `mf` output you want to preview.

## Options

```ts
export interface AddonOptions {
  rslib?: {
    /**
     * Working directory passed to Rslib's loadConfig
     * @default undefined
     */
    cwd?: string
    /**
     * Path passed to Rslib's loadConfig
     * @default undefined
     */
    configPath?: string
    /**
     * Select which `lib` entry to reuse. The chosen entry is merged with the rest of the config.
     * Provide a number to pick that index, or `false` to skip merging any entry.
     * @default 0
     */
    libIndex?: number | false
    /**
     * Modify the Rslib lib config before it is converted into an Rsbuild config.
     * Mutate the provided config object in place.
     * @experimental subject to change at any time
     * @default undefined
     */
    modifyLibConfig?: (config: LibConfig) => void
    /**
     * Modify the transformed Rsbuild config before Storybook merges it.
     * Mutate the provided config object in place.
     * @experimental subject to change at any time
     * @default undefined
     */
    modifyLibRsbuildConfig?: (config: RsbuildConfig) => void
  }
}
```
